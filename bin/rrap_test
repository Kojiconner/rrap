#!/usr/bin/env python3

#from rrap import main
from unittest.mock import patch
import unittest
import filecmp
import os
import subprocess
import rrap

def test_main():
    # use relative paths
    dirname = os.path.dirname(__file__)
    cleaned_dir_txt_file = os.path.join(dirname, '..', 'tests', 'metaG_paths.txt')
    print(dirname, cleaned_dir_txt_file)
    subprocess.call('cat {0}'.format(cleaned_dir_txt_file), shell=True)

    with patch("sys.argv", ['-i', 
                            '/Users/connerkojima/thrash/cykojima/rrap_test/cleaned_dir_paths.txt', 
                            '-rg', 
                            '/Users/connerkojima/thrash/cykojima/rrap_test/LD12_genomes/', 
                            '-o', 
                            '/Users/connerkojima/thrash/cykojima/rrap_test/output_dir', 
                            '-n', 
                            'test_24', 
                            '--merge-contigs', 
                            '-suffix', 
                            '"--', 
                            '-QUALITY_PASSED_R1.fastq"']):
        rrap.main()
        unittest.Testcase.assertTrue(filecmp.cmp("first.doc","second.doc",shallow=False))

test_main()