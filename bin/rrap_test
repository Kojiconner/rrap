#!/usr/bin/env python3

#from rrap import main
from unittest.mock import patch
import unittest
import filecmp
import os
import subprocess
from rrap import controller

def test_main():
    # use relative paths
    dirname = os.path.dirname(__file__)

    with patch("sys.argv", ['rrap', 
                            '-i',
                            os.path.join(os.path.dirname(__file__), '..', 'tests', 'metaG_paths.txt'), 
                            '-rg', 
                            os.path.join(os.path.dirname(__file__), '..', 'tests', 'reference'), 
                            '-o', 
                            os.path.join(os.path.dirname(__file__), '..', 'tests', 'output'), 
                            '-n', 
                            'val', 
                            '--merge-contigs', 
                            '-suffix', 
                            '_toy_R1.fastq']):
        controller.main()
        # unittest.Testcase.assertTrue(filecmp.cmp("first.doc","second.doc",shallow=False))

if __name__ == "__main__":
    test_main()